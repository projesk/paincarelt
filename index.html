<!DOCTYPE html>
<html lang="lt">
<head>
  <meta charset="UTF-8" />
  <title>PainCare LT â€“ Geriatrinio paciento skausmo vertinimas</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <style>
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      margin: 0;
      background: #f5f5f7;
      color: #222;
    }
    .app {
      max-width: 1000px;
      margin: 0 auto;
      padding: 20px 12px 40px;
    }
    h1 { font-size: 1.7rem; margin-bottom: 0.25rem; }
    h2 { font-size: 1.3rem; margin-top: 1.5rem; margin-bottom: 0.5rem; }
    h3 { margin: 0.7rem 0 0.25rem; }

    .card {
      background: #ffffff;
      border-radius: 12px;
      padding: 16px 18px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.06);
      margin-top: 16px;
    }

    .hint {
      font-size: 0.9rem;
      color: #555;
    }

    label {
      display: block;
      margin-top: 8px;
    }

    input[type="number"] {
      padding: 6px 10px;
      border-radius: 6px;
      border: 1px solid #ccc;
      margin-top: 4px;
      width: 120px;
    }

    .primary-btn {
      border-radius: 999px;
      border: none;
      padding: 8px 16px;
      font-size: 0.95rem;
      cursor: pointer;
      background: #4b7bec;
      color: #fff;
      margin-top: 10px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.18);
    }

    .secondary-btn {
      border-radius: 999px;
      border: 1px solid #4b7bec;
      padding: 6px 14px;
      font-size: 0.9rem;
      cursor: pointer;
      background: #fff;
      color: #4b7bec;
      margin-top: 10px;
      margin-left: 4px;
    }

    .radio-row {
      display: grid;
      grid-template-columns: 40px 1.3fr 2fr 240px;
      gap: 10px;
      align-items: flex-start;
      padding: 6px 0;
      border-bottom: 1px solid #eee;
      font-size: 0.92rem;
    }

    .radio-header {
      font-weight: 600;
      border-bottom: 2px solid #ddd;
      margin-top: 8px;
      padding-bottom: 4px;
    }

    .radio-group {
      display: flex;
      gap: 12px;
      flex-wrap: wrap;
    }

    .radio-group label {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      margin-top: 0;
      font-size: 0.88rem;
      cursor: pointer;
    }

    .badge {
      display: inline-block;
      padding: 2px 8px;
      border-radius: 999px;
      background: #f1f2f6;
      font-size: 0.78rem;
      margin-left: 6px;
    }

    .hidden { display:none; }

    .mmse-figure-box {
      margin-top: 12px;
      padding: 10px;
      border-radius: 10px;
      background: #f1f2f6;
      display: inline-block;
    }

    .mmse-figure-box p {
      margin: 0 0 6px 0;
      font-size: 0.85rem;
      color: #444;
    }

    /* --- Iowa spalvÅ³ gradientas (Å¾alia â†’ raudona) --- */
    .iowa-label {
      border-radius: 999px;
      padding: 4px 8px;
      display: inline-flex;
      align-items: center;
      gap: 4px;
      font-size: 0.9rem;
    }
    .iowa-0 { background: #d4f8d4; }
    .iowa-1 { background: #e6f9c7; }
    .iowa-2 { background: #fdf3c4; }
    .iowa-3 { background: #ffe0b5; }
    .iowa-4 { background: #ffc9c9; }
    .iowa-5 { background: #ffb3b3; }
    .iowa-6 { background: #ff9e9e; }

    /* --- FPS-R veidukai --- */
    .faces-option {
      font-size: 1.5rem;
      padding: 6px 10px;
      border-radius: 10px;
      background: #f1f2f6;
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }
    .faces-option span.desc {
      font-size: 0.85rem;
    }
    /* DVPRS spalviniai blokai */
    .dvprs-mild   { background: #e3f9e5; }
    .dvprs-moderate { background: #fff9e3; }
    .dvprs-severe { background: #ffe5e5; }

    .dvprs-item {
      border-radius: 10px;
      padding: 8px 10px;
      font-size: 0.85rem;
      display: flex;
      align-items: flex-start;
      gap: 6px;
    }

    .dvprs-score-badge {
      font-weight: 600;
      margin-right: 4px;
    }

    .dvprs-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
      gap: 10px;
      margin-top: 10px;
    }

    @media (max-width: 800px) {
      .radio-row {
        grid-template-columns: 30px 1fr;
        grid-template-rows: auto auto auto;
      }
      .radio-row .item-title { grid-column: 2 / 3; }
      .radio-row .item-meaning { grid-column: 2 / 3; }
      .radio-row .radio-group { grid-column: 2 / 3; }
      .radio-header { display: none; }
    }
  </style>
</head>

<body>
<div class="app">

  <!-- ========================================= -->
  <!--             PRADINIS EKRANAS              -->
  <!-- ========================================= -->

  <div id="screen-start">
    <div class="card">
      <h1>PainCare LT</h1>
      <p class="hint">
        1 Å¾ingsnis â€“ Ä¯veskite MMSE<br>
        2 Å¾ingsnis â€“ sistema automatiÅ¡kai parinks tinkamÄ… skausmo skalÄ™<br>
        3 Å¾ingsnis â€“ gausite skausmo Ä¯vertinimÄ… ir rekomendacijas
      </p>

      <h2>1. Ä®veskite MMSE balus</h2>
      <label>
        MMSE balai (0â€“30):
        <input type="number" id="start-mmse" min="0" max="30" step="1">
      </label>

      <button class="primary-btn" onclick="handleStartWithMmse()">TÄ™sti</button>
      <button class="secondary-btn" onclick="goToMmseForm()">NeÅ¾inau â€“ atlikti MMSE testÄ…</button>
    </div>
  </div>


  <!-- ========================================= -->
  <!--                MMSE FORMOS                -->
  <!-- ========================================= -->

  <div id="screen-mmse" class="hidden">
    <div class="card">
      <h2>MMSE â€“ Mini psichikos bÅ«klÄ—s Ä¯vertinimas</h2>

      <p class="hint">
        MMSE Ä¯vertina orientacijÄ…, dÄ—mesÄ¯, atmintÄ¯, kalbÄ… ir konstrukcinius gebÄ—jimus.<br>
        <br>
        Interpretacija:<br>
        â€¢ <strong>24â€“30</strong> â€“ kognityviniÅ³ sutrikimÅ³ nÄ—ra / minimalÅ«s<br>
        â€¢ <strong>18â€“23</strong> â€“ lengvi sutrikimai<br>
        â€¢ <strong>0â€“17</strong> â€“ ryÅ¡kÅ«s sutrikimai
      </p>

      <div class="radio-row radio-header">
        <div>#</div>
        <div>Punktas</div>
        <div>Instrukcija</div>
        <div>Ä®vertinimas</div>
      </div>

      <div id="mmse-form-items"></div>

      <div class="mmse-figure-box">
        <p>PavyzdinÄ— figÅ«ra, kuriÄ… pacientas turi nukopijuoti:</p>
        <svg width="180" height="120" viewBox="0 0 180 120">
          <polygon points="60,15 25,50 38,95 82,95 95,50"
                   fill="none" stroke="#333" stroke-width="2"/>
          <polygon points="110,25 75,60 88,105 132,105 145,60"
                   fill="none" stroke="#333" stroke-width="2"/>
        </svg>
      </div>

      <button class="primary-btn" onclick="calculateMmseFromForm(true)">
        ApskaiÄiuoti MMSE ir tÄ™sti
      </button>

      <button class="secondary-btn" onclick="showScreen('screen-start')">
        GrÄ¯Å¾ti
      </button>

      <div id="mmse-form-result" style="display:none; margin-top:10px; border-left:4px solid #4b7bec; padding-left:12px;">
        <p id="mmse-form-main"></p>
      </div>

      <p class="hint" style="margin-top:10px;">
        Nuoroda Ä¯ lietuviÅ¡kÄ… MMSE PDF:<br>
        <a href="http://www.loravita.lt/formos/MMSE.pdf" target="_blank">
          MMSE (lietuviÅ¡ka forma, PDF)
        </a>
      </p>
    </div>
  </div>
  <!-- ========================================= -->
  <!--             SKAUSMO SKALÄ–S                -->
  <!-- ========================================= -->

  <div id="screen-scales" class="hidden">

    <div class="card">
      <h2>2. Skausmo skalÄ—s parinkimas</h2>
      <p id="scale-intro" class="hint"></p>
    </div>

    <!-- Å aka 18â€“23 -->
    <div id="branch-18-23" class="card hidden">
      <h3>Lengvi kognityviniai sutrikimai (MMSE 18â€“23)</h3>
      <p class="hint">
        Ar pacientas geba suprasti paprastÄ… vizualinÄ™ ir Å¾odinÄ™ informacijÄ…?
      </p>

      <button class="primary-btn" onclick="branch1823('yes')">
        Taip â€“ vizualinÄ—s skalÄ—s (Iowa, VDS, veidukai, NRS)
      </button>

      <button class="secondary-btn" onclick="branch1823('no')">
        Ne â€“ PAINAD skalÄ—
      </button>
    </div>

    <!-- Å aka 0â€“17 -->
    <div id="branch-0-17" class="card hidden">
      <h3>SunkÅ«s sutrikimai (MMSE 0â€“17)</h3>
      <p class="hint">Pasirink pagal situacijÄ…:</p>

      <button class="primary-btn" onclick="branch017Quick()">
        Greitas Ä¯vertinimas â€“ Abbey
      </button>

      <button class="secondary-btn" onclick="branch017Detailed()">
        IÅ¡samus vertinimas â€“ PAIC-15
      </button>
    </div>

    <!-- PAIC apmokymo klausimas -->
    <div id="branch-0-17-paic" class="card hidden">
      <h3>IÅ¡samus vertinimas</h3>
      <p class="hint">Ar mokate naudoti PAIC-15?</p>

      <button class="primary-btn" onclick="branch017Paic('yes')">
        Taip â€“ PAIC-15
      </button>
      <button class="secondary-btn" onclick="branch017Paic('no')">
        Ne â€“ Abbey skalÄ—
      </button>

      <p class="hint">
        PAIC-15 mokymai:  
        <a href="https://paic15.org/en/1" target="_blank">https://paic15.org/en/1</a>
      </p>
    </div>

    <!-- ========================================= -->
    <!--          PAPRASTOS SKALÄ–S (Iowa/VDS/FPS/NRS) -->
    <!-- ========================================= -->

    <div id="card-simple" class="card hidden">
      <h2>Iowa, Å¾odinÄ—, veidukai, NRS</h2>

      <!-- Iowa -->
      <h3>Iowa Pain Thermometer</h3>
      <p class="hint">Spalvos: Å¾alia â†’ raudona, nuo neskauda iki labai skauda.</p>

      <div class="radio-group">
        <label class="iowa-label iowa-0">
          <input type="radio" name="iowa-thermo" value="0">
          <span>0 â€“ NÄ—ra skausmo</span>
        </label>

        <label class="iowa-label iowa-1">
          <input type="radio" name="iowa-thermo" value="1">
          <span>1 â€“ Vos juntamas</span>
        </label>

        <label class="iowa-label iowa-2">
          <input type="radio" name="iowa-thermo" value="2">
          <span>2 â€“ Lengvas</span>
        </label>

        <label class="iowa-label iowa-3">
          <input type="radio" name="iowa-thermo" value="3">
          <span>3 â€“ Vidutinis</span>
        </label>

        <label class="iowa-label iowa-4">
          <input type="radio" name="iowa-thermo" value="4">
          <span>4 â€“ Stiprus</span>
        </label>

        <label class="iowa-label iowa-5">
          <input type="radio" name="iowa-thermo" value="5">
          <span>5 â€“ Labai stiprus</span>
        </label>

        <label class="iowa-label iowa-6">
          <input type="radio" name="iowa-thermo" value="6">
          <span>6 â€“ Smarkiausias Ä¯manomas skausmas</span>
        </label>
      </div>

      <hr>

      <!-- VDS -->
      <h3>Å½odinÄ— skausmo skalÄ— (VDS)</h3>
      <div class="radio-group">
        <label><input type="radio" name="vds" value="0">0 â€“ nÄ—ra</label>
        <label><input type="radio" name="vds" value="1">1 â€“ lengvas</label>
        <label><input type="radio" name="vds" value="2">2 â€“ vidutinis</label>
        <label><input type="radio" name="vds" value="3">3 â€“ stiprus</label>
      </div>

      <hr>

      <!-- FPS-R -->
      <h3>VeidukÅ³ skalÄ— (FPS-R)</h3>
      <p class="hint">Pasirink veidukÄ….</p>

      <div class="radio-group">
        <label class="faces-option">
          <input type="radio" name="faces" value="0">
          <span>ğŸ™‚</span><span class="desc">NÄ—ra skausmo</span>
        </label>

        <label class="faces-option">
          <input type="radio" name="faces" value="2">
          <span>ğŸ˜Š</span><span class="desc">Labai lengvas</span>
        </label>

        <label class="faces-option">
          <input type="radio" name="faces" value="4">
          <span>ğŸ˜</span><span class="desc">Lengvas</span>
        </label>

        <label class="faces-option">
          <input type="radio" name="faces" value="6">
          <span>ğŸ˜•</span><span class="desc">Vidutinis</span>
        </label>

        <label class="faces-option">
          <input type="radio" name="faces" value="8">
          <span>ğŸ˜£</span><span class="desc">Stiprus</span>
        </label>

        <label class="faces-option">
          <input type="radio" name="faces" value="10">
          <span>ğŸ˜­</span><span class="desc">Labai stiprus</span>
        </label>
      </div>

      <hr>

      <!-- NRS -->
      <h3>NRS (0â€“10)</h3>
      <div style="display:flex;align-items:center;gap:8px;flex-wrap:wrap;">
        <input type="range" id="nrs-slider" min="0" max="10" value="0"
               oninput="document.getElementById('nrs-value').textContent=this.value">
        <span><strong>NRS:</strong> <span id="nrs-value">0</span>/10</span>
      </div>

      <button class="primary-btn" onclick="summarizeSimpleScales()">
        ApskaiÄiuoti
      </button>

      <div id="simple-scales-result" style="display:none;">
        <p id="simple-scales-main"></p>
        <p id="simple-scales-interpretation" class="hint"></p>
      </div>
    </div>


    <!-- ========================================= -->
    <!--                DVPRS                     -->
    <!-- ========================================= -->

    <div id="card-dvprs" class="card hidden">
      <h2>DVPRS (0â€“10)</h2>

      <div id="dvprs-options" class="dvprs-grid"></div>

      <button class="primary-btn" onclick="calculateDvprs()">SkaiÄiuoti</button>

      <div id="dvprs-result-box" style="display:none;">
        <p id="dvprs-result-main"></p>
        <p id="dvprs-result-interpretation" class="hint"></p>
      </div>
    </div>


    <!-- ========================================= -->
    <!--                 PAINAD                    -->
    <!-- ========================================= -->

    <div id="card-painad" class="card hidden">
      <h2>PAINAD (0â€“10)</h2>
      <p class="hint">Vertinama stebint pacientÄ… ~5 minutes.</p>

      <div class="radio-row radio-header">
        <div>#</div>
        <div>Kategorija</div>
        <div>PavyzdÅ¾iai</div>
        <div>Balai</div>
      </div>

      <div id="painad-items"></div>

      <button class="primary-btn" onclick="calculatePainad()">
        SkaiÄiuoti PAINAD
      </button>

      <div id="painad-result-box" style="display:none;">
        <p id="painad-result-main"></p>
        <p id="painad-result-interpretation" class="hint"></p>
      </div>
    </div>


    <!-- ========================================= -->
    <!--                PAIC-15                    -->
    <!-- ========================================= -->

    <div id="card-paic" class="card hidden">
      <h2>PAIC-15</h2>
      <p class="hint">0 â€“ nÄ—ra, 1 â€“ Å¡iek tiek, 2 â€“ vidutiniÅ¡kai, 3 â€“ ryÅ¡kiai, X â€“ nevertinta</p>

      <div class="radio-row radio-header">
        <div>#</div>
        <div>PoÅ¾ymis</div>
        <div>PaaiÅ¡kinimas</div>
        <div>Balai</div>
      </div>

      <div id="paic-items"></div>

      <button class="primary-btn" onclick="calculatePaic()">
        SkaiÄiuoti PAIC
      </button>

      <div id="paic-result-box" style="display:none;">
        <p id="paic-result-main"></p>
        <p id="paic-result-interpretation" class="hint"></p>
      </div>
    </div>


    <!-- ========================================= -->
    <!--                   ABBEY                   -->
    <!-- ========================================= -->

    <div id="card-abbey" class="card hidden">
      <h2>Abbey skausmo skalÄ—</h2>

      <p class="hint">0 â€“ nÄ—ra, 1 â€“ lengvas, 2 â€“ vidutinis, 3 â€“ ryÅ¡kus.</p>

      <div class="radio-row radio-header">
        <div>#</div>
        <div>PoÅ¾ymis</div>
        <div>PavyzdÅ¾iai</div>
        <div>Balai</div>
      </div>

      <div id="abbey-items"></div>

      <h3>Skausmo tipas</h3>
      <div class="radio-group">
        <label><input type="radio" name="abbey-type" value="Chronic">LÄ—tinis</label>
        <label><input type="radio" name="abbey-type" value="Acute">Åªminis</label>
        <label><input type="radio" name="abbey-type" value="Acute on chronic">Åªminis lÄ—tinio fone</label>
      </div>

      <button class="primary-btn" onclick="calculateAbbey()">
        SkaiÄiuoti Abbey
      </button>

      <div id="abbey-result-box" style="display:none;">
        <p id="abbey-result-main"></p>
        <p id="abbey-result-interpretation" class="hint"></p>
      </div>
    </div>


    <!-- ========================================= -->
    <!--          SKAUSMO REKOMENDACIJOS           -->
    <!-- ========================================= -->

    <div id="recommend-card" class="card hidden">
      <h2>3. Rekomendacijos pagal skausmÄ…</h2>
      <p id="recommend-main"></p>
      <p id="recommend-extra" class="hint"></p>
    </div>

    <div class="card">
      <button class="primary-btn" onclick="resetApp()">Naujas pacientas</button>
    </div>

  </div> <!-- end screen-scales -->
<script>
  let currentMmseScore = null;

  function showScreen(id) {
    ['screen-start','screen-mmse','screen-scales'].forEach(s => {
      const el = document.getElementById(s);
      if (!el) return;
      el.classList.toggle('hidden', s !== id);
    });
  }

  function handleStartWithMmse() {
    const val = Number(document.getElementById('start-mmse').value);
    if (isNaN(val) || val < 0 || val > 30) {
      alert('Ä®veskite MMSE balus nuo 0 iki 30.');
      return;
    }
    currentMmseScore = val;
    routeByMmse(val);
  }

  function goToMmseForm() {
    showScreen('screen-mmse');
  }

  /* ============================================================
     MMSE ROUTING â†’ parenka skalÄ™
  ============================================================ */

  function routeByMmse(score) {
    const intro = document.getElementById('scale-intro');

    // paslepiam visas skales
    [
      'card-simple','card-dvprs','card-painad','card-paic','card-abbey',
      'recommend-card','branch-18-23','branch-0-17','branch-0-17-paic'
    ].forEach(id => document.getElementById(id).classList.add('hidden'));

    if (score >= 24) {
      intro.textContent =
        `MMSE ${score} â€“ kognityviniÅ³ sutrikimÅ³ nÄ—ra. Rekomenduojama DVPRS skalÄ—.`;
      document.getElementById('card-dvprs').classList.remove('hidden');
    }
    else if (score >= 18) {
      intro.textContent =
        `MMSE ${score} â€“ lengvi sutrikimai. Reikia patikrinti, ar supranta vizualinÄ™ informacijÄ….`;
      document.getElementById('branch-18-23').classList.remove('hidden');
    }
    else {
      intro.textContent =
        `MMSE ${score} â€“ sunkÅ«s sutrikimai. Pasirinkite greitÄ… (Abbey) arba iÅ¡samÅ³ (PAIC-15) Ä¯vertinimÄ….`;
      document.getElementById('branch-0-17').classList.remove('hidden');
    }

    showScreen('screen-scales');
  }

  function branch1823(option) {
    document.getElementById('card-simple').classList.add('hidden');
    document.getElementById('card-painad').classList.add('hidden');

    if (option === 'yes') {
      document.getElementById('card-simple').classList.remove('hidden');
    } else {
      document.getElementById('card-painad').classList.remove('hidden');
    }
  }

  function branch017Quick() {
    document.getElementById('branch-0-17-paic').classList.add('hidden');
    document.getElementById('card-paic').classList.add('hidden');
    document.getElementById('card-abbey').classList.remove('hidden');
  }

  function branch017Detailed() {
    document.getElementById('branch-0-17-paic').classList.remove('hidden');
  }

  function branch017Paic(option) {
    document.getElementById('card-paic').classList.add('hidden');
    document.getElementById('card-abbey').classList.add('hidden');

    if (option === 'yes') {
      document.getElementById('card-paic').classList.remove('hidden');
    } else {
      document.getElementById('card-abbey').classList.remove('hidden');
    }
  }

  /* ============================================================
     MMSE formos skaiÄiavimas
  ============================================================ */

  function calculateMmseFromForm(continueToScales) {
    const items = document.querySelectorAll('[name^="mmse-"]');
    let total = 0;

    items.forEach(input => {
      const checked = document.querySelector(`input[name="${input.name}"]:checked`);
      if (checked) total += Number(checked.value);
    });

    currentMmseScore = total;
    document.getElementById('mmse-form-main').innerHTML =
      `<strong>MMSE suma: ${total} balai.</strong>`;
    document.getElementById('mmse-form-result').style.display = 'block';

    if (continueToScales) routeByMmse(total);
  }

  /* ============================================================
     PAPRASTOS SKALÄ–S (Iowa / VDS / FPS-R / NRS)
  ============================================================ */

  function summarizeSimpleScales() {
    const iowaSel = document.querySelector('input[name="iowa-thermo"]:checked');
    const vdsSel = document.querySelector('input[name="vds"]:checked');
    const facesSel = document.querySelector('input[name="faces"]:checked');
    const nrsVal = Number(document.getElementById('nrs-slider').value);

    let levelKey = 'none';
    if (nrsVal >= 7) levelKey = 'severe';
    else if (nrsVal >= 4) levelKey = 'moderate';
    else if (nrsVal >= 1) levelKey = 'mild';

    document.getElementById('simple-scales-main').innerHTML = `
      <strong>Iowa:</strong> ${(iowaSel ? iowaSel.parentElement.textContent : 'â€“')}<br>
      <strong>VDS:</strong> ${(vdsSel ? vdsSel.parentElement.textContent : 'â€“')}<br>
      <strong>Veidukai:</strong> ${(facesSel ? facesSel.value : 'â€“')}<br>
      <strong>NRS:</strong> ${nrsVal}/10
    `;

    document.getElementById('simple-scales-result').style.display = 'block';
    showRecommendations(levelKey);
  }

  /* ============================================================
     DVPRS
  ============================================================ */

  const dvprsItems = [
    {score:0, text:'NÄ—ra skausmo'},
    {score:1, text:'VOS jauÄiamas'},
    {score:2, text:'Labai lengvas'},
    {score:3, text:'Lengvas'},
    {score:4, text:'Vidutinis'},
    {score:5, text:'Vidutinis trikdantis'},
    {score:6, text:'Skausmas riboja veiklÄ…'},
    {score:7, text:'Stiprus'},
    {score:8, text:'Labai stiprus'},
    {score:9, text:'Beveik nepakeliamas'},
    {score:10,text:'Blogiausias Ä¯manomas'}
  ];

  // renderuojame DVPRS grid
  const dvprsContainer = document.getElementById('dvprs-options');
  dvprsItems.forEach(item => {
    const div = document.createElement('div');
    let c = '';
    if (item.score <= 3) c='dvprs-mild';
    else if (item.score <= 6) c='dvprs-moderate';
    else c='dvprs-severe';

    div.className = `dvprs-item ${c}`;
    div.innerHTML = `
      <input type="radio" name="dvprs-score" value="${item.score}">
      <span><strong>${item.score}:</strong> ${item.text}</span>
    `;
    dvprsContainer.appendChild(div);
  });

  function calculateDvprs() {
    const sel = document.querySelector('input[name="dvprs-score"]:checked');
    if (!sel) {
      alert('Pasirinkite DVPRS balÄ….');
      return;
    }
    const val = Number(sel.value);

    let levelKey = 'none';
    if (val >= 7) levelKey = 'severe';
    else if (val >= 4) levelKey = 'moderate';
    else if (val >= 1) levelKey = 'mild';

    document.getElementById('dvprs-result-main').innerHTML =
      `<strong>DVPRS:</strong> ${val} â€“ ${dvprsItems[val].text}`;
    document.getElementById('dvprs-result-box').style.display = 'block';

    showRecommendations(levelKey);
  }

  /* ============================================================
     PAINAD
  ============================================================ */

  const painadItems = [
    {id:'breathing',label:['Normalus','RetkarÄiais sunkesnis','Garsiai apsunkintas']},
    {id:'vocal',label:['NÄ—ra','Dejuoja, pÅ«kÅ¡Äia','Å aukia, verkia']},
    {id:'facial',label:['Neutrali','LiÅ«dna/susiraukusi','AiÅ¡ki grimasa']},
    {id:'body',label:['Ramus','Ä®temptas','SustingÄ™s, ginasi']},
    {id:'console',label:['Nereikia','Nusiramina','Nenuraminamas']}
  ];

  const painadContainer = document.getElementById('painad-items');
  let pIndex=1;

  painadItems.forEach(item => {
    const div = document.createElement('div');
    div.className='radio-row';
    div.innerHTML = `
      <div>${pIndex++}</div>
      <div><strong>${item.id}</strong></div>
      <div>
        0 â€“ ${item.label[0]}<br>
        1 â€“ ${item.label[1]}<br>
        2 â€“ ${item.label[2]}
      </div>
      <div class="radio-group">
        <label><input type="radio" name="painad-${item.id}" value="0">0</label>
        <label><input type="radio" name="painad-${item.id}" value="1">1</label>
        <label><input type="radio" name="painad-${item.id}" value="2">2</label>
      </div>
    `;
    painadContainer.appendChild(div);
  });

  function calculatePainad() {
    let total=0;
    painadItems.forEach(item => {
      const sel=document.querySelector(`input[name="painad-${item.id}"]:checked`);
      if(sel) total+=Number(sel.value);
    });

    let levelKey='none';
    if (total>=7) levelKey='severe';
    else if (total>=4) levelKey='moderate';
    else if (total>=1) levelKey='mild';

    document.getElementById('painad-result-main').innerHTML =
      `<strong>PAINAD:</strong> ${total}/10`;

    document.getElementById('painad-result-box').style.display='block';

    showRecommendations(levelKey);
  }

  /* ============================================================
     PAIC-15
  ============================================================ */

  const paicItems = [
    {id:'1',title:'Suraukta kakta'},
    {id:'2',title:'Primerktos akys'},
    {id:'3',title:'Pakelta virÅ¡utinÄ— lÅ«pa'},
    {id:'4',title:'Praveriama burna'},
    {id:'5',title:'Ä®tempta veido iÅ¡raiÅ¡ka'},
    {id:'6',title:'SustabarÄ—jimas'},
    {id:'7',title:'Apsauginiai judesiai'},
    {id:'8',title:'PrieÅ¡inimasis prieÅ¾iÅ«rai'},
    {id:'9',title:'Trinimas'},
    {id:'10',title:'Nerimastingumas'},
    {id:'11',title:'Skausmo Å¾odÅ¾iai'},
    {id:'12',title:'Å aukimas'},
    {id:'13',title:'Dejavimas'},
    {id:'14',title:'MurmÄ—jimas'},
    {id:'15',title:'Skundimasis'}
  ];

  const paicContainer = document.getElementById('paic-items');
  let idx=1;

  paicItems.forEach(i => {
    const row=document.createElement('div');
    row.className='radio-row';
    row.innerHTML=`
      <div>${idx++}</div>
      <div><strong>${i.title}</strong></div>
      <div>StebÄ—ti poÅ¾ymÄ¯ 0â€“3, X jei nevertinama</div>
      <div class="radio-group">
        <label><input type="radio" name="paic-${i.id}" value="0">0</label>
        <label><input type="radio" name="paic-${i.id}" value="1">1</label>
        <label><input type="radio" name="paic-${i.id}" value="2">2</label>
        <label><input type="radio" name="paic-${i.id}" value="3">3</label>
        <label><input type="radio" name="paic-${i.id}" value="x">X</label>
      </div>
    `;
    paicContainer.appendChild(row);
  });

  function calculatePaic() {
    let total=0;
    paicItems.forEach(i=>{
      const sel=document.querySelector(`input[name="paic-${i.id}"]:checked`);
      if(sel && sel.value!=='x') total+=Number(sel.value);
    });

    let levelKey='none';
    if (total>=31) levelKey='severe';
    else if (total>=16) levelKey='moderate';
    else if (total>=6) levelKey='mild';

    document.getElementById('paic-result-main').innerHTML =
      `<strong>PAIC-15:</strong> ${total}/45`;

    document.getElementById('paic-result-box').style.display='block';

    showRecommendations(levelKey);
  }

  /* ============================================================
     ABBEY
  ============================================================ */

  const abbeyItems = [
    'vocal','face','body','behaviour','phys','skin'
  ];

  const abbeyContainer = document.getElementById('abbey-items');
  let a=1;

  abbeyItems.forEach(id=>{
    const row=document.createElement('div');
    row.className='radio-row';
    row.innerHTML=`
      <div>${a++}</div>
      <div><strong>${id}</strong></div>
      <div>0-nÄ—ra,1-lengvi,2-vidutiniai,3-ryÅ¡kÅ«s</div>
      <div class="radio-group">
        <label><input type="radio" name="abbey-${id}" value="0">0</label>
        <label><input type="radio" name="abbey-${id}" value="1">1</label>
        <label><input type="radio" name="abbey-${id}" value="2">2</label>
        <label><input type="radio" name="abbey-${id}" value="3">3</label>
      </div>
    `;
    abbeyContainer.appendChild(row);
  });

  function calculateAbbey() {
    let sum=0;
    abbeyItems.forEach(id=>{
      const sel=document.querySelector(`input[name="abbey-${id}"]:checked`);
      if(sel) sum+=Number(sel.value);
    });

    let levelKey='none';
    if(sum>=14) levelKey='severe';
    else if(sum>=8) levelKey='moderate';
    else if(sum>=3) levelKey='mild';

    document.getElementById('abbey-result-main').innerHTML =
      `<strong>Abbey:</strong> ${sum}/18`;

    document.getElementById('abbey-result-box').style.display='block';

    showRecommendations(levelKey);
  }

  /* ============================================================
     REKOMENDACIJOS
  ============================================================ */

  function showRecommendations(level) {
    const main=document.getElementById('recommend-main');
    const extra=document.getElementById('recommend-extra');
    const card=document.getElementById('recommend-card');

    if(level === 'none') {
      main.textContent = 'Skausmo nÄ—ra arba jis minimalus.';
      extra.textContent = 'TÄ™sti stebÄ—senÄ…. Pakartoti vertinimÄ… pagal situacijÄ….';
    }
    if(level === 'mild') {
      main.textContent = 'Lengvas skausmas.';
      extra.textContent = 'Tinka nefarmakologinÄ—s priemonÄ—s, Å¡velnÅ«s analgetikai.';
    }
    if(level === 'moderate') {
      main.textContent = 'Vidutinio stiprumo skausmas.';
      extra.textContent = 'Reikalingas kombinuotas gydymas: paracetamolis + NVNU.';
    }
    if(level === 'severe') {
      main.textContent = 'Stiprus skausmas.';
      extra.textContent = 'Reikia intensyvaus gydymo, galimi opioidai, daÅ¾na kontrolÄ—.';
    }

    card.classList.remove('hidden');
  }

  /* ============================================================
     RESET
  ============================================================ */

  function resetApp() {
    window.location.reload();
  }
</script>
</body>
</html>
